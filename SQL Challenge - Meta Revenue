Question #1: 
How has the revenue of Instagram changed over the years? Provide a summary of total revenue per year for Instagram.
Hint/s
How can you filter data in a text column?
How do you aggregate data while including a grouping in your result?

Solution
SELECT years, -- definitely want to include the group by variable in the select statement
			 SUM(revenue) AS total_revenue -- "total revenue" is just the sum of revenue
       
FROM meta_revenue 

WHERE parent_company = 'Instagram'

GROUP BY years

ORDER BY years -- we want to be able to read the table with the years in order
;

Question #2: 
What is the revenue in 2022 and 2021  generated by the Video ad type on both platforms (Facebook and Instagram) combined? Did revenue grow?
Hint/s
How do you filter data in a text column based on a pattern?
How do you aggregate data while including a grouping in your result?

Solution
SELECT years, 
			 SUM(revenue) AS total_revenue
       
FROM meta_revenue 

WHERE years BETWEEN 2021 AND 2022 -- we could have used an OR here too but would have to use brackets
			AND ad_types LIKE '%Video%' -- could have used OR statements here as well, but this is more concise

GROUP BY years
;

Question #3: 
Create a column called “ad_products” that creates one value that groups the Display ad types together and one value that groups the Video ad types together. 
What is the total revenue generated by each ad product? 
Hint/s
How can you create a column based on a condition using CASE WHEN?
How do you group your data by a new CASE WHEN statement?

Solution
SELECT CASE WHEN ad_types LIKE '%Video%' THEN 'Video'
						WHEN ad_types LIKE '%Display%' THEN 'Display'
            ELSE 'Error' -- have to write an else to capture the remaining cases
       END AS ad_product, 
			 SUM(revenue) AS total_revenue
       
FROM meta_revenue 

GROUP BY ad_product
;

Question #4: 
Can you identify the ad_id of Video ads that have generated over 2 million in revenue in 2022? 

Note: the revenue numbers are already in millions, so 2 million will show up as 2 in the data.

Hint/s
How do you aggregate the data per ad_id?
How do you filter aggregated data?

Solution
-- we can't filter total revenue until we aggregate revenue
-- this mean we'll be filtering in a HAVING clause
SELECT ad_id,
			 SUM(revenue) AS total_revenue
       
FROM meta_revenue 

WHERE ad_types LIKE '%Video%'
			AND years = 2022

GROUP BY ad_id
         
HAVING SUM(revenue) > 2
;
