Question #1: 
How has the revenue of Instagram changed over the years? Provide a summary of total revenue per year for Instagram.
Hint/s
How can you filter data in a text column?
How do you aggregate data while including a grouping in your result?

Solution
SELECT years, -- definitely want to include the group by variable in the select statement
			 SUM(revenue) AS total_revenue -- "total revenue" is just the sum of revenue
       
FROM meta_revenue 

WHERE parent_company = 'Instagram'

GROUP BY years

ORDER BY years -- we want to be able to read the table with the years in order
;

Question #2: 
What is the revenue in 2022 and 2021  generated by the Video ad type on both platforms (Facebook and Instagram) combined? Did revenue grow?
Hint/s
How do you filter data in a text column based on a pattern?
How do you aggregate data while including a grouping in your result?

Solution
SELECT years, 
			 SUM(revenue) AS total_revenue
       
FROM meta_revenue 

WHERE years BETWEEN 2021 AND 2022 -- we could have used an OR here too but would have to use brackets
			AND ad_types LIKE '%Video%' -- could have used OR statements here as well, but this is more concise

GROUP BY years
;

Question #3: 
Create a column called “ad_products” that creates one value that groups the Display ad types together and one value that groups the Video ad types together. 
What is the total revenue generated by each ad product? 
Hint/s
How can you create a column based on a condition using CASE WHEN?
How do you group your data by a new CASE WHEN statement?

Solution
SELECT CASE WHEN ad_types LIKE '%Video%' THEN 'Video'
						WHEN ad_types LIKE '%Display%' THEN 'Display'
            ELSE 'Error' -- have to write an else to capture the remaining cases
       END AS ad_product, 
			 SUM(revenue) AS total_revenue
       
FROM meta_revenue 

GROUP BY ad_product
;

Question #4: 
Can you identify the ad_id of Video ads that have generated over 2 million in revenue in 2022? 

Note: the revenue numbers are already in millions, so 2 million will show up as 2 in the data.

Hint/s
How do you aggregate the data per ad_id?
How do you filter aggregated data?

Solution
-- we can't filter total revenue until we aggregate revenue
-- this mean we'll be filtering in a HAVING clause
SELECT ad_id,
			 SUM(revenue) AS total_revenue
       
FROM meta_revenue 

WHERE ad_types LIKE '%Video%'
			AND years = 2022

GROUP BY ad_id
         
HAVING SUM(revenue) > 2
;


Question #5: 
Summarize the number of clicks that have been generated for each year where the user and the advertiser have the same geographical code

Hint/s
How do you aggregate data using a grouping?
You can compare the values of two columns using a condition in a WHERE clause!

Solution
Copy
SELECT years, 
			 SUM(clicks) AS total_clicks

FROM meta_revenue 

WHERE geo_user = geo_advertiser 

GROUP BY years
;

Question #6: 
Create a new column that splits the data between domestic activity and international activity. Domestic activity means that the user and advertiser have the same geography code. International activity means that the user and advertiser have a different geography codes.

How much revenue has been generated through domestic activity versus international activity in 2022 for each platform (Instagram and Facebook)?

Hint/s
You can reuse the condition created in question 1 and use it in a new column
How can you group your data based on a CASE WHEN statement?

Solution
Copy
SELECT parent_company, 
			 CASE WHEN geo_user = geo_advertiser THEN 'Domestic'
       			WHEN geo_user != geo_advertiser THEN 'International'
            ELSE 'Error'
       END AS geo_group,
			 SUM(revenue) AS total_revenue

FROM meta_revenue 

WHERE years = 2022 

GROUP BY parent_company, 
	geo_group
;


Question #7: 
Analyze if there is a clear distinction in the sales of the LCS (Large Customer Sales) and SMB (Small and Medium Businesses) sales teams. Anything that doesn’t match LCS or SMB can be called Other.

How much revenue did the LCS and SMB sales teams generate in 2022 split between domestic and international activity?

Hint/s
International activity refers to the definition of question 6. Use this to filter your data.
How did we group the LCS and SMB sales teams together in the Wednesday live session?

Solution
Copy
SELECT CASE WHEN sales_team LIKE '%LCS%' THEN 'LCS'
       			WHEN sales_team LIKE '%SMB%' THEN 'SMB'
            ELSE 'Other'
       END AS sales_segment,
			 CASE WHEN geo_user = geo_advertiser THEN 'Domestic'
       			WHEN geo_user != geo_advertiser THEN 'International'
            ELSE 'Error'
       END AS geo_group,
			 SUM(revenue) AS total_revenue

FROM meta_revenue

WHERE years = 2022 

GROUP BY sales_segment,
				 geo_group
         
ORDER BY sales_segment
;

